# Windows Anti-malware Batch Script

## Description 
This is a Windows batch script that extracts the malware root program's path based on the blacklisted destination IP address(es).

## Required Windows 11 Configuration

- [Windows Security Audit Step 1](https://superuser.com/questions/1052541/how-can-i-get-a-history-of-running-processes): Build the entire historical process tree
- [Windows Security Audit Step 2](https://docs.nxlog.co/userguide/integrate/windows-command-line-auditing.html): Collect process command line

## Running the Batch Script
1. Reboot Windows 11.
2. Open PowerShell with the Admin privilege.
3. Open `INPUT-BlacklistIP.txt` and write the malicious target destination IP address.
4. From PowerShell, run `main-network.batch`, which will continously monitor and write the driving running/exited parent process IDs to `TEMP-ppid.txt`.
5. From PowerShell, run `main-syslog.batch`, which will recursively detect and extract the information (e.g., file system path, launch command, etc) of all parent processes.
6. Carefully delete those process files that are not the Windows core system files. Note that some folders are completely hidden and accessible only by PowerShell with the admin privilege. 
